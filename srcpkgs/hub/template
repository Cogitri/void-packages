# Template file for 'hub'
pkgname=hub
version=2.8.4
revision=1
build_style=go
go_import_path=github.com/github/hub
hostmakedepends="git"
depends="hub-man"
short_desc="Command line tool for Github"
maintainer="Enno Boland <gottox@voidlinux.org>"
license="MIT"
homepage="https://hub.github.com/"
changelog="https://github.com/github/hub/releases"
distfiles="https://github.com/github/hub/archive/v${version}.tar.gz"
checksum=0aa1342ac5701dc9b7e787ad69640ede06fc84cbe88fb63440b81aca4d4b6273

subpackages=" "

if ! [ "$CROSS_BUILD" ]; then
	hostmakedepends+=" groff"
	subpackages="hub-docs hub-man"
fi

post_install() {
	if ! [ "$CROSS_BUILD" ]; then
		# Can't build md2roff for cross target and run on host
		make man-pages

		for m in share/man/man1/*.1; do
			vman $m
		done

		for d in share/man/man1/*.html; do
			vdoc $d
		done
	fi

	vlicense LICENSE

	vinstall etc/hub.zsh_completion 644 usr/share/zsh/site-functions _hub
	vinstall etc/hub.bash_completion.sh 644 usr/share/bash-completion/completions hub
	vinstall etc/hub.fish_completion 644 usr/share/fish/completions hub.fish
}

hub-doc_package() {
	short_desc+=" - documentation"
	noarch=yes
	pkg_install() {
		vmove usr/share/doc
	}
}

hub-man_package() {
	short_desc+=" - manpages"
	noarch=yes
	pkg_install() {
		vmove usr/share/man
	}
}
